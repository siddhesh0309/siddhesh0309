# Loop through each unique customer
for customer in buyfp_df['Customer Normalized'].dropna().unique():
    # Extract month for that customer's records (adjust this part if looping by date range)
    for period in buyfp_df[buyfp_df['Customer Normalized'] == customer]['Date'].dt.to_period('M').unique():
        sheet_name = period.strftime('%b')  # e.g., Jun, Jul

        try:
            config_df = pd.read_excel("customer_config.xlsx", sheet_name=sheet_name)
        except Exception:
            print(f"Skipping {customer} for {sheet_name}: sheet not found in config.")
            continue

        # Match on 'Customer' column
        config = config_df[config_df['Customer'].str.lower() == customer.lower()]
        if config.empty:
            print(f"Skipping {customer} for {sheet_name}: config not found.")
            continue

        config = config.iloc[0]
        tbill, spread, tenor, roi = config['TBILL RATE'], config['SPREAD'], config['TENOR'], config['ROI']

        # Now apply tbill, spread, roi, etc. as needed for this month's processing
