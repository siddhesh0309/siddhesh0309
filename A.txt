    for period in all_dates.dt.to_period('M').unique():
        sheet_name = period.strftime('%b-%Y')  # e.g., Dec-2024
        start = period.to_timestamp()
        end = start + pd.offsets.MonthEnd(0)

        try:
            config_df = pd.read_excel("customer_config.xlsx", sheet_name=sheet_name)
        except:
            print(f"⛔ Sheet {sheet_name} not found. Skipping {customer}.")
            continue

        config = config_df[config_df['Customer'].str.lower() == customer.lower()]
        if config.empty:
            print(f"⛔ No config for {customer} in {sheet_name}. Skipping.")
            continue

        config = config.iloc[0]
        tbill, spread, tenor, roi = config['TBILL RATE'], config['SPREAD'], config['TENOR'], config['ROI']
